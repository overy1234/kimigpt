# 🔒 무료 서비스 제한사항 및 고려사항

## 📊 현재 사용 중인 무료 서비스 제한

### 1. Hugging Face API (Kimi-K2)
**제한사항:**
- ⚠️ **Rate Limit**: 무료 티어는 시간당 요청 수 제한 (명확하지 않음, 일반적으로 1000-5000 req/day)
- ⚠️ **동시 요청**: 동시 처리 제한 있음
- ⚠️ **응답 속도**: 유료보다 느릴 수 있음
- ⚠️ **가용성**: 서비스 중단 가능성
- 💰 **유료 전환 필요 시점**: 월 10,000 요청 이상 시 Pro 고려

**대응 방안:**
```python
# Rate limiting 추가 필요
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(
    app=app,
    key_func=get_remote_address,
    default_limits=["100 per day", "10 per hour"]
)
```

### 2. Vercel 호스팅
**무료 티어 제한:**
- ✅ **대역폭**: 100GB/월 (충분함)
- ✅ **빌드 시간**: 100시간/월
- ✅ **함수 실행**: 100GB-시간/월
- ⚠️ **함수 실행 시간**: 최대 10초 (Hobby), 60초 (Pro)
- ⚠️ **메모리**: 1024MB
- ⚠️ **Serverless 한계**: 대규모 트래픽 시 Cold Start 발생

**주의:**
- 사용자 100-1000명/일: 무료로 충분
- 사용자 10,000명/일 이상: Pro 플랜 필요 ($20/월)

### 3. Railway (대안)
**무료 티어:**
- ⚠️ **$5 크레딧/월만 제공**
- 초과 시 서비스 정지

### 4. Render (대안)
**무료 티어:**
- ⚠️ **15분 비활성 시 슬립 모드**
- 첫 요청 시 깨어나는데 30초-1분 소요
- 월 750시간 제한 (충분함)

---

## 🎯 추천 아키텍처 (무료 유지)

### Phase 1: 소규모 (1-100 사용자/일)
```
현재 구조 그대로 사용
- Vercel (무료)
- Hugging Face (무료)
- 제한: 없음
```

### Phase 2: 중규모 (100-1000 사용자/일)
```
+ Rate Limiting 추가
+ 사용자당 일일 메시지 제한 (예: 20회)
+ 캐싱 도입 (Redis - Upstash 무료 티어)
```

### Phase 3: 대규모 (1000+ 사용자/일)
```
+ Vercel Pro ($20/월)
+ Cloudflare (CDN/DDoS 방어)
+ 데이터베이스 (사용량 추적)
```

---

## 💰 비용 시뮬레이션

### 시나리오 A: 일 100명, 1인당 10회 대화
- **총 요청**: 1,000 req/day = 30,000 req/month
- **Hugging Face**: 무료 ✅
- **Vercel**: 무료 ✅
- **총 비용**: $0/월

### 시나리오 B: 일 1,000명, 1인당 10회 대화
- **총 요청**: 10,000 req/day = 300,000 req/month
- **Hugging Face**: 제한 초과 가능성 ⚠️
- **Vercel**: 무료 (아슬아슬) ⚠️
- **총 비용**: $0-20/월

### 시나리오 C: 일 10,000명, 1인당 10회 대화
- **총 요청**: 100,000 req/day = 3,000,000 req/month
- **Hugging Face**: API 한도 초과 ❌
- **Vercel**: Pro 필요 ❌
- **총 비용**: $50-100/월 (Vercel Pro + HF Pro)

---

## 🛡️ 무료 유지 전략

### 1. Rate Limiting (필수!)
```python
# 사용자당 제한
- 1시간당 10회 대화
- 1일당 50회 대화
- IP 기반 제한
```

### 2. 대화 길이 제한
```python
# 토큰 절약
max_tokens=500  # 현재 2000에서 줄이기
```

### 3. 캐싱
```python
# 자주 묻는 질문 캐싱
# Redis나 메모리 캐시 활용
```

### 4. 사용량 모니터링
```python
# Google Analytics 또는
# Vercel Analytics (무료)
```

### 5. 쿠키/세션 기반 제한
```python
# 로그인 없이도 남용 방지
```

---

## ⚠️ 주의사항

### 법적 문제
1. **개인정보보호법**: 대화 내용 저장 시 명시 필요
2. **AI 윤리**: 유해 콘텐츠 필터링 필요
3. **서비스 약관**: Hugging Face 약관 준수

### 기술적 문제
1. **DDoS 공격**: Cloudflare 사용 추천
2. **스팸/봇**: CAPTCHA 추가 고려
3. **데이터 유출**: API 키 노출 금지

### 비즈니스 문제
1. **수익 모델 없음**: 광고 수익으로 서버비 충당
2. **확장성**: 사용자 급증 시 대응 방안 필요

---

## 🎯 추천 설정

### 현재 즉시 추가할 것:
1. ✅ **Rate Limiting** (하루 20회/IP)
2. ✅ **에러 처리** (API 실패 시 안내)
3. ✅ **Analytics** (사용량 추적)
4. ✅ **광고 공간** (수익화)

### 나중에 고려할 것:
1. 💰 유료 플랜 (무제한 사용)
2. 📊 사용자 대시보드
3. 🔐 로그인 시스템
4. 💾 대화 히스토리 저장

---

## 📈 확장 로드맵

### 단계 1: MVP (현재)
- 무료, 제한 없음
- 목표: 100명 사용자

### 단계 2: 성장기 (1-3개월)
- Rate limiting 추가
- 광고 수익 시작
- 목표: 1,000명 사용자

### 단계 3: 확장기 (3-6개월)
- 유료 플랜 도입
- 서버 업그레이드
- 목표: 10,000명 사용자

---

## 💡 결론

**현재 구조로 충분히 무료 운영 가능:**
- 일 500명까지는 문제없음
- Rate limiting만 추가하면 안정적
- 광고 수익으로 서버비 충당 가능

**위험 요소:**
- Hugging Face API 제한 (가장 큰 리스크)
- 급격한 사용자 증가
- 악의적 사용자/봇

**대응 방안:**
- Rate limiting 즉시 구현
- 사용량 모니터링
- 백업 API 준비 (OpenAI GPT-3.5 등)
